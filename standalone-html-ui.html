<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E2E Encrypted Messenger</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        * {
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons as SVG components
        const Shield = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.618 5.984A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
        );

        const Lock = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
        );

        const User = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
        );

        const Send = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
        );

        const Mail = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
        );

        const LogOut = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
        );

        const MessageSquare = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
        );

        const AlertCircle = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const RefreshCw = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        // Main App Component
        const E2EMessenger = () => {
            const API_URL = 'http://localhost:5000/api';
            const [view, setView] = useState('landing');
            const [session, setSession] = useState(null);
            const [messages, setMessages] = useState([]);
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');
            const [loading, setLoading] = useState(false);
            const [apiMode, setApiMode] = useState(false);
            
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');
            const [recipient, setRecipient] = useState('');
            const [messageText, setMessageText] = useState('');

            // Check if API is available on mount
            useEffect(() => {
                fetch(`${API_URL}/health`)
                    .then(res => res.json())
                    .then(() => setApiMode(true))
                    .catch(() => setApiMode(false));
            }, []);

            const showError = (msg) => {
                setError(msg);
                setTimeout(() => setError(''), 4000);
            };

            const showSuccess = (msg) => {
                setSuccess(msg);
                setTimeout(() => setSuccess(''), 3000);
            };

            const apiCall = async (endpoint, method = 'GET', body = null) => {
                const options = {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                };
                if (body) options.body = JSON.stringify(body);
                
                const response = await fetch(`${API_URL}${endpoint}`, options);
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Request failed');
                }
                
                return data;
            };

            const handleSignup = async () => {
                if (!username || username.length < 3) {
                    showError('Username must be at least 3 characters');
                    return;
                }
                if (!password || password.length < 8) {
                    showError('Password must be at least 8 characters');
                    return;
                }
                if (password !== confirmPassword) {
                    showError('Passwords do not match');
                    return;
                }

                if (apiMode) {
                    setLoading(true);
                    try {
                        const data = await apiCall('/signup', 'POST', { username, password });
                        showSuccess(data.message || 'Account created! Please log in.');
                        setView('login');
                        setUsername('');
                        setPassword('');
                        setConfirmPassword('');
                    } catch (err) {
                        showError(err.message);
                    } finally {
                        setLoading(false);
                    }
                } else {
                    // Demo mode
                    showSuccess('Account created! Please log in. (Demo Mode)');
                    setView('login');
                    setUsername('');
                    setPassword('');
                    setConfirmPassword('');
                }
            };

            const handleLogin = async () => {
                if (!username || !password) {
                    showError('Please enter username and password');
                    return;
                }

                if (apiMode) {
                    setLoading(true);
                    try {
                        const data = await apiCall('/login', 'POST', { username, password });
                        setSession({ username: data.username, token: data.session_token });
                        showSuccess(`Welcome back, ${data.username}!`);
                        setView('main');
                        setUsername('');
                        setPassword('');
                        loadMessages(data.session_token);
                    } catch (err) {
                        showError(err.message);
                    } finally {
                        setLoading(false);
                    }
                } else {
                    // Demo mode - accept alice or bob
                    if ((username === 'alice' || username === 'bob') && password === 'demo') {
                        setSession({ username: username, token: 'demo_token' });
                        showSuccess(`Welcome, ${username}! (Demo Mode)`);
                        setView('main');
                        setUsername('');
                        setPassword('');
                        loadDemoMessages();
                    } else {
                        showError('Demo mode: Use alice/demo or bob/demo');
                    }
                }
            };

            const loadMessages = async (token = null) => {
                const sessionToken = token || session?.token;
                if (!sessionToken || !apiMode) return;

                try {
                    const data = await apiCall('/inbox', 'POST', { session_token: sessionToken });
                    setMessages(data.messages || []);
                } catch (err) {
                    console.error('Failed to load messages:', err);
                }
            };

            const loadDemoMessages = () => {
                const demoMessages = [
                    {
                        id: 1,
                        from: 'alice',
                        message: 'Hey! This is a demo message. Connect to Python backend for real encryption!',
                        timestamp: new Date().toISOString(),
                        decrypted: true
                    },
                    {
                        id: 2,
                        from: 'bob',
                        message: 'To use real E2E encryption, run: python api.py',
                        timestamp: new Date(Date.now() - 3600000).toISOString(),
                        decrypted: true
                    }
                ];
                setMessages(demoMessages);
            };

            const handleSendMessage = async () => {
                if (!recipient || !messageText) {
                    showError('Please enter recipient and message');
                    return;
                }

                if (apiMode) {
                    setLoading(true);
                    try {
                        await apiCall('/send', 'POST', {
                            session_token: session.token,
                            recipient: recipient,
                            message: messageText
                        });
                        showSuccess(`Message sent to ${recipient}!`);
                        setRecipient('');
                        setMessageText('');
                        loadMessages();
                    } catch (err) {
                        showError(err.message);
                    } finally {
                        setLoading(false);
                    }
                } else {
                    showSuccess(`Demo: Message would be sent to ${recipient}. Run 'python api.py' for real encryption!`);
                    setRecipient('');
                    setMessageText('');
                }
            };

            const handleLogout = async () => {
                if (apiMode) {
                    try {
                        await apiCall('/logout', 'POST', { session_token: session?.token });
                    } catch (err) {
                        console.error('Logout error:', err);
                    }
                }
                setSession(null);
                setView('landing');
                setMessages([]);
                showSuccess('Logged out successfully');
            };

            // Landing Page
            if (view === 'landing') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 flex items-center justify-center p-4">
                        <div className="max-w-4xl w-full">
                            <div className="text-center mb-12">
                                <div className="flex justify-center mb-6">
                                    <div className="bg-white/10 backdrop-blur-lg rounded-full p-6">
                                        <Shield className="w-20 h-20 text-white" />
                                    </div>
                                </div>
                                <h1 className="text-6xl font-bold text-white mb-4">E2E Messenger</h1>
                                <p className="text-xl text-white/90 mb-2">End-to-End Encrypted Messaging</p>
                                <p className="text-white/70">Secure. Private. Simple.</p>
                                
                                {!apiMode && (
                                    <div className="mt-4 bg-yellow-500/20 border border-yellow-500/50 rounded-xl p-3 inline-block">
                                        <p className="text-yellow-200 text-sm">
                                            🔄 Demo Mode - Run <code className="bg-black/20 px-2 py-1 rounded">python api.py</code> for real encryption
                                        </p>
                                    </div>
                                )}
                                {apiMode && (
                                    <div className="mt-4 bg-green-500/20 border border-green-500/50 rounded-xl p-3 inline-block">
                                        <p className="text-green-200 text-sm">
                                            ✓ Connected to Python Backend
                                        </p>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl mb-8">
                                <div className="grid md:grid-cols-3 gap-6">
                                    <div className="text-center">
                                        <div className="bg-white/20 rounded-2xl p-4 mb-4 inline-block">
                                            <Lock className="w-10 h-10 text-white" />
                                        </div>
                                        <h3 className="text-white font-semibold mb-2">RSA + AES Encryption</h3>
                                        <p className="text-white/70 text-sm">Military-grade hybrid encryption</p>
                                    </div>
                                    <div className="text-center">
                                        <div className="bg-white/20 rounded-2xl p-4 mb-4 inline-block">
                                            <Shield className="w-10 h-10 text-white" />
                                        </div>
                                        <h3 className="text-white font-semibold mb-2">Zero Knowledge</h3>
                                        <p className="text-white/70 text-sm">We can't read your messages</p>
                                    </div>
                                    <div className="text-center">
                                        <div className="bg-white/20 rounded-2xl p-4 mb-4 inline-block">
                                            <MessageSquare className="w-10 h-10 text-white" />
                                        </div>
                                        <h3 className="text-white font-semibold mb-2">Simple & Fast</h3>
                                        <p className="text-white/70 text-sm">Easy to use, lightning quick</p>
                                    </div>
                                </div>
                            </div>

                            <div className="flex gap-4 justify-center">
                                <button
                                    onClick={() => setView('login')}
                                    className="bg-white text-purple-600 px-8 py-4 rounded-2xl font-semibold text-lg hover:bg-gray-100 transition-all transform hover:scale-105 shadow-lg"
                                >
                                    Log In
                                </button>
                                <button
                                    onClick={() => setView('signup')}
                                    className="bg-white/20 backdrop-blur text-white px-8 py-4 rounded-2xl font-semibold text-lg hover:bg-white/30 transition-all transform hover:scale-105 shadow-lg"
                                >
                                    Sign Up
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Login Page
            if (view === 'login') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 flex items-center justify-center p-4">
                        <div className="max-w-md w-full bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl">
                            <div className="text-center mb-8">
                                <div className="bg-white/20 rounded-full p-4 inline-block mb-4">
                                    <User className="w-12 h-12 text-white" />
                                </div>
                                <h2 className="text-3xl font-bold text-white mb-2">Welcome Back</h2>
                                <p className="text-white/70">Log in to your account</p>
                                {!apiMode && (
                                    <p className="text-yellow-200 text-sm mt-2">Demo: alice/demo or bob/demo</p>
                                )}
                            </div>

                            {error && (
                                <div className="bg-red-500/20 border border-red-500/50 rounded-xl p-4 mb-4 flex items-center gap-2">
                                    <AlertCircle className="w-5 h-5 text-red-300" />
                                    <p className="text-white text-sm">{error}</p>
                                </div>
                            )}

                            {success && (
                                <div className="bg-green-500/20 border border-green-500/50 rounded-xl p-4 mb-4">
                                    <p className="text-white text-sm">{success}</p>
                                </div>
                            )}

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-white mb-2 text-sm font-medium">Username</label>
                                    <input
                                        type="text"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                        placeholder="Enter your username"
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                        disabled={loading}
                                    />
                                </div>

                                <div>
                                    <label className="block text-white mb-2 text-sm font-medium">Password</label>
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                        placeholder="Enter your password"
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                        disabled={loading}
                                    />
                                </div>

                                <button
                                    onClick={handleLogin}
                                    disabled={loading}
                                    className="w-full bg-white text-purple-600 py-3 rounded-xl font-semibold hover:bg-gray-100 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                                >
                                    {loading ? (
                                        <>
                                            <RefreshCw className="w-4 h-4 animate-spin" />
                                            Logging in...
                                        </>
                                    ) : (
                                        'Log In'
                                    )}
                                </button>

                                <div className="text-center">
                                    <button
                                        onClick={() => setView('signup')}
                                        className="text-white/80 hover:text-white text-sm"
                                        disabled={loading}
                                    >
                                        Don't have an account? <span className="font-semibold">Sign up</span>
                                    </button>
                                </div>

                                <button
                                    onClick={() => setView('landing')}
                                    className="w-full text-white/70 hover:text-white text-sm py-2"
                                    disabled={loading}
                                >
                                    ← Back
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Signup Page
            if (view === 'signup') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 flex items-center justify-center p-4">
                        <div className="max-w-md w-full bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl">
                            <div className="text-center mb-8">
                                <div className="bg-white/20 rounded-full p-4 inline-block mb-4">
                                    <Shield className="w-12 h-12 text-white" />
                                </div>
                                <h2 className="text-3xl font-bold text-white mb-2">Create Account</h2>
                                <p className="text-white/70">Join the secure messenger</p>
                            </div>

                            {error && (
                                <div className="bg-red-500/20 border border-red-500/50 rounded-xl p-4 mb-4 flex items-center gap-2">
                                    <AlertCircle className="w-5 h-5 text-red-300" />
                                    <p className="text-white text-sm">{error}</p>
                                </div>
                            )}

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-white mb-2 text-sm font-medium">Username</label>
                                    <input
                                        type="text"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                        placeholder="Choose a username (min 3 chars)"
                                        disabled={loading}
                                    />
                                </div>

                                <div>
                                    <label className="block text-white mb-2 text-sm font-medium">Password</label>
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                        placeholder="Choose a password (min 8 chars)"
                                        disabled={loading}
                                    />
                                </div>

                                <div>
                                    <label className="block text-white mb-2 text-sm font-medium">Confirm Password</label>
                                    <input
                                        type="password"
                                        value={confirmPassword}
                                        onChange={(e) => setConfirmPassword(e.target.value)}
                                        className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                        placeholder="Confirm your password"
                                        onKeyPress={(e) => e.key === 'Enter' && handleSignup()}
                                        disabled={loading}
                                    />
                                </div>

                                <button
                                    onClick={handleSignup}
                                    disabled={loading}
                                    className="w-full bg-white text-purple-600 py-3 rounded-xl font-semibold hover:bg-gray-100 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                                >
                                    {loading ? (
                                        <>
                                            <RefreshCw className="w-4 h-4 animate-spin" />
                                            Creating account...
                                        </>
                                    ) : (
                                        'Create Account'
                                    )}
                                </button>

                                <div className="text-center">
                                    <button
                                        onClick={() => setView('login')}
                                        className="text-white/80 hover:text-white text-sm"
                                        disabled={loading}
                                    >
                                        Already have an account? <span className="font-semibold">Log in</span>
                                    </button>
                                </div>

                                <button
                                    onClick={() => setView('landing')}
                                    className="w-full text-white/70 hover:text-white text-sm py-2"
                                    disabled={loading}
                                >
                                    ← Back
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Main App
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-6 mb-4 shadow-lg">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <div className="bg-white/20 rounded-full p-3">
                                        <Shield className="w-8 h-8 text-white" />
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold text-white">E2E Messenger</h1>
                                        <p className="text-white/70 text-sm">Logged in as {session?.username}</p>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    {apiMode && (
                                        <button
                                            onClick={() => loadMessages()}
                                            className="flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-xl transition-all"
                                            title="Refresh messages"
                                        >
                                            <RefreshCw className="w-4 h-4" />
                                        </button>
                                    )}
                                    <button
                                        onClick={handleLogout}
                                        className="flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-xl transition-all"
                                    >
                                        <LogOut className="w-4 h-4" />
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>

                        {success && (
                            <div className="bg-green-500/20 border border-green-500/50 rounded-xl p-4 mb-4">
                                <p className="text-white text-sm">{success}</p>
                            </div>
                        )}

                        {error && (
                            <div className="bg-red-500/20 border border-red-500/50 rounded-xl p-4 mb-4 flex items-center gap-2">
                                <AlertCircle className="w-5 h-5 text-red-300" />
                                <p className="text-white text-sm">{error}</p>
                            </div>
                        )}

                        <div className="grid md:grid-cols-2 gap-4">
                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-6 shadow-lg">
                                <div className="flex items-center gap-3 mb-6">
                                    <div className="bg-white/20 rounded-full p-2">
                                        <Send className="w-6 h-6 text-white" />
                                    </div>
                                    <h2 className="text-2xl font-bold text-white">Send Message</h2>
                                </div>

                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-white mb-2 text-sm font-medium">To:</label>
                                        <input
                                            type="text"
                                            value={recipient}
                                            onChange={(e) => setRecipient(e.target.value)}
                                            className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60"
                                            placeholder="Username"
                                            disabled={loading}
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-white mb-2 text-sm font-medium">Message:</label>
                                        <textarea
                                            value={messageText}
                                            onChange={(e) => setMessageText(e.target.value)}
                                            className="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-white/60 h-32 resize-none"
                                            placeholder="Type your encrypted message..."
                                            disabled={loading}
                                        />
                                    </div>

                                    <button
                                        onClick={handleSendMessage}
                                        disabled={loading}
                                        className="w-full bg-white text-purple-600 py-3 rounded-xl font-semibold hover:bg-gray-100 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                                    >
                                        {loading ? (
                                            <>
                                                <RefreshCw className="w-5 h-5 animate-spin" />
                                                Encrypting & Sending...
                                            </>
                                        ) : (
                                            <>
                                                <Send className="w-5 h-5" />
                                                Send Encrypted Message
                                            </>
                                        )}
                                    </button>
                                </div>
                            </div>

                            <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-6 shadow-lg">
                                <div className="flex items-center gap-3 mb-6">
                                    <div className="bg-white/20 rounded-full p-2">
                                        <Mail className="w-6 h-6 text-white" />
                                    </div>
                                    <h2 className="text-2xl font-bold text-white">Inbox</h2>
                                </div>

                                <div className="space-y-3 max-h-96 overflow-y-auto">
                                    {messages.length === 0 ? (
                                        <div className="text-center py-8 text-white/60">
                                            <Mail className="w-12 h-12 mx-auto mb-3 opacity-50" />
                                            <p>No messages yet</p>
                                        </div>
                                    ) : (
                                        messages.map((msg) => (
                                            <div
                                                key={msg.id}
                                                className="bg-white/20 rounded-2xl p-4 hover:bg-white/25 transition-all"
                                            >
                                                <div className="flex items-start justify-between mb-2">
                                                    <span className="text-white font-semibold">{msg.from}</span>
                                                    <span className="text-white/60 text-xs">
                                                        {msg.timestamp ? new Date(msg.timestamp).toLocaleTimeString() : ''}
                                                    </span>
                                                </div>
                                                <p className="text-white/90 text-sm">{msg.message}</p>
                                                {msg.decrypted && (
                                                    <div className="flex items-center gap-1 mt-2">
                                                        <Lock className="w-3 h-3 text-green-300" />
                                                        <span className="text-green-300 text-xs">Decrypted</span>
                                                    </div>
                                                )}
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="mt-4 bg-white/10 backdrop-blur-lg rounded-3xl p-4 text-center">
                            <p className="text-white/70 text-sm">
                                🔐 All messages are encrypted end-to-end using RSA-2048 + AES-256-GCM
                            </p>
                            {!apiMode && (
                                <p className="text-yellow-200 text-xs mt-2">
                                    Demo Mode: Run <code className="bg-black/20 px-2 py-1 rounded">python api.py</code> to enable real encryption
                                </p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<E2EMessenger />);
    </script>
</body>
</html>